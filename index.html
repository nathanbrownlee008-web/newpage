<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Top Daily Tips</title>

<link rel="manifest" href="manifest.json">

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;
  background:#0b1220;
  color:white;
}

header{
  padding:18px;
  font-size:20px;
  font-weight:600;
  border-bottom:1px solid #1f2a44;
  text-align:center;
}

nav{
  display:flex;
  justify-content:space-around;
  border-bottom:1px solid #1f2a44;
  padding:10px 0;
}

nav button{
  background:none;
  border:none;
  color:white;
  font-size:13px;
}

.container{ padding:15px; }

table{ width:100%; border-collapse:collapse; font-size:13px; }

th, td{
  padding:8px;
  border-bottom:1px solid #1f2a44;
  text-align:left;
}

th{ opacity:0.7; }

tr.win{ border-left:4px solid #10b981; }
tr.loss{ border-left:4px solid #ef4444; }

tr{ transition:0.3s ease; }

input, select{
  background:#121a2b;
  border:1px solid #2a3a5e;
  color:white;
  padding:5px;
  font-size:12px;
}

button.small{
  font-size:11px;
  padding:4px 6px;
}

.stat-box{
  background:#121a2b;
  padding:12px;
  margin-bottom:15px;
  border-radius:8px;
}

canvas{
  width:100%;
  height:220px;
  background:#121a2b;
  border-radius:8px;
}

.green{ color:#10b981; }
.red{ color:#ef4444; }
</style>
</head>

<body>

<header>Top Daily Tips</header>

<nav>
  <button onclick="setTab('value')">ğŸ’ Value</button>
  <button onclick="setTab('history')">ğŸ“œ History</button>
  <button onclick="setTab('pl')">ğŸ“ˆ P/L</button>
  <button onclick="adminLogin()">ğŸ”’ Admin</button>
</nav>

<div class="container">
  <div id="content"></div>
</div>

<script>

if('serviceWorker' in navigator){
  navigator.serviceWorker.register('sw.js');
}

let bets = JSON.parse(localStorage.getItem("bets")) || [];
let startingBankroll = parseFloat(localStorage.getItem("bankroll")) || 1000;
let adminPassword = localStorage.getItem("adminPass") || "admin123";
let tab="value";

function save(){
  localStorage.setItem("bets", JSON.stringify(bets));
  localStorage.setItem("bankroll", startingBankroll);
  localStorage.setItem("adminPass", adminPassword);
}

function today(){ return new Date().toISOString().split("T")[0]; }

function profit(o,s,r){
  if(r==="win") return (o-1)*s;
  if(r==="loss") return -s;
  return 0;
}

function setTab(t){ tab=t; render(); }

function adminLogin(){
  const pass = prompt("Enter admin password:");
  if(pass===adminPassword){ tab="admin"; render(); }
  else alert("Wrong password");
}

function addBet(){
  bets.unshift({
    id:Date.now(),
    date:today(),
    match:"",
    market:"",
    odds:2,
    stake:100,
    result:"pending"
  });
  save();
  setTab("value");
}

function update(id, field, value){
  bets=bets.map(b=>b.id===id?{...b,[field]:value}:b);
  save();
  render();
}

function removeBet(id){
  if(confirm("Delete bet?")){
    bets=bets.filter(b=>b.id!==id);
    save();
    render();
  }
}

function render(){

const content=document.getElementById("content");
content.innerHTML="";

if(tab==="value"){

  const table=document.createElement("table");
  table.innerHTML=`
  <tr>
    <th>Match</th>
    <th>Odds</th>
    <th>Stake</th>
    <th>Status</th>
    <th></th>
  </tr>`;

  bets.filter(b=>b.date===today())
      .sort((a,b)=>b.id-a.id)
      .forEach(b=>{

    const row=document.createElement("tr");
    row.className=b.result==="win"?"win":b.result==="loss"?"loss":"";

    row.innerHTML=`
      <td><input value="${b.match}" onchange="update(${b.id},'match',this.value)"></td>
      <td><input type="number" value="${b.odds}" onchange="update(${b.id},'odds',parseFloat(this.value)||0)"></td>
      <td><input type="number" value="${b.stake}" onchange="update(${b.id},'stake',parseFloat(this.value)||0)"></td>
      <td>
        <select onchange="update(${b.id},'result',this.value)">
          <option value="pending">â³</option>
          <option value="win">âœ…</option>
          <option value="loss">âŒ</option>
        </select>
      </td>
      <td><button class="small" onclick="removeBet(${b.id})">ğŸ—‘</button></td>
    `;
    table.appendChild(row);
  });

  content.appendChild(table);
}

if(tab==="history"){
  const table=document.createElement("table");
  table.innerHTML=`
  <tr><th>Match</th><th>Result</th><th>Profit</th></tr>`;

  bets.filter(b=>b.result!=="pending")
      .sort((a,b)=>b.id-a.id)
      .forEach(b=>{

    const p=profit(b.odds,b.stake,b.result);
    const row=document.createElement("tr");
    row.className=b.result;
    row.innerHTML=`
      <td>${b.match}</td>
      <td>${b.result==="win"?"âœ…":"âŒ"}</td>
      <td class="${p>=0?'green':'red'}">Â£${p.toFixed(2)}</td>
    `;
    table.appendChild(row);
  });

  content.appendChild(table);
}

if(tab==="pl"){

  const totalProfit=bets.reduce((a,b)=>a+profit(b.odds,b.stake,b.result),0);

  const stat=document.createElement("div");
  stat.className="stat-box";
  stat.innerHTML=`
    Starting Bankroll (Â£):
    <input type="number" value="${startingBankroll}" onchange="startingBankroll=parseFloat(this.value)||0; save(); render();">
    <br><br>
    Current Bankroll: Â£${(startingBankroll+totalProfit).toFixed(2)}
  `;
  content.appendChild(stat);

  const canvas=document.createElement("canvas");
  content.appendChild(canvas);

  const ctx=canvas.getContext("2d");
  canvas.width=window.innerWidth-30;
  canvas.height=220;

  let history=bets.filter(b=>b.result!=="pending");
  let bankroll=startingBankroll;
  let points=[bankroll];

  history.forEach(b=>{
    bankroll+=profit(b.odds,b.stake,b.result);
    points.push(bankroll);
  });

  let max=Math.max(...points);
  let min=Math.min(...points);
  let range=max-min||1;

  ctx.strokeStyle="#2a3a5e";
  ctx.beginPath();
  for(let i=0;i<5;i++){
    let y=i*(canvas.height/4);
    ctx.moveTo(0,y);
    ctx.lineTo(canvas.width,y);
  }
  ctx.stroke();

  ctx.strokeStyle="#10b981";
  ctx.beginPath();

  points.forEach((val,i)=>{
    const x=(canvas.width/(points.length-1))*i;
    const y=canvas.height-((val-min)/range)*canvas.height;
    if(i===0) ctx.moveTo(x,y);
    else ctx.lineTo(x,y);
  });

  ctx.stroke();
}

if(tab==="admin"){
  content.innerHTML=`
    <div class="stat-box">
      <button onclick="addBet()">â• Add Bet</button>
      <br><br>
      Change Admin Password:
      <input type="text" value="${adminPassword}" onchange="adminPassword=this.value; save();">
    </div>
  `;
}

}

render();
</script>

</body>
</html>
