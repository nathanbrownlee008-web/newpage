<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>Top Daily Tips</title>

<style>
body{
  margin:0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background:#0b1220;
  color:white;
}

header{
  padding:20px;
  font-size:22px;
  font-weight:600;
  border-bottom:1px solid #1f2a44;
}

nav{
  display:flex;
  justify-content:space-around;
  border-bottom:1px solid #1f2a44;
  padding:10px 0;
}

nav button{
  background:none;
  border:none;
  color:white;
  font-size:14px;
}

.container{
  padding:15px;
}

table{
  width:100%;
  border-collapse:collapse;
  font-size:13px;
}

th, td{
  padding:8px;
  border-bottom:1px solid #1f2a44;
  text-align:left;
}

th{
  font-weight:600;
  opacity:0.7;
}

tr.win{
  border-left:4px solid #10b981;
}

tr.loss{
  border-left:4px solid #ef4444;
}

input, select{
  background:#121a2b;
  border:1px solid #2a3a5e;
  color:white;
  padding:5px;
  font-size:12px;
}

.stat-box{
  background:#121a2b;
  padding:12px;
  margin-bottom:15px;
  border-radius:8px;
}

canvas{
  width:100%;
  height:200px;
  background:#121a2b;
  border-radius:8px;
}
</style>
</head>

<body>

<header>Top Daily Tips</header>

<nav>
  <button onclick="setTab('value')">ğŸ’ Value</button>
  <button onclick="setTab('history')">ğŸ“œ History</button>
  <button onclick="setTab('pl')">ğŸ“ˆ P/L</button>
  <button onclick="adminLogin()">ğŸ”’ Admin</button>
</nav>

<div class="container">
  <div id="content"></div>
</div>

<script>

let bets = JSON.parse(localStorage.getItem("bets")) || [];
let startingBankroll = parseFloat(localStorage.getItem("bankroll")) || 1000;
let tab="value";

function save(){
  localStorage.setItem("bets", JSON.stringify(bets));
  localStorage.setItem("bankroll", startingBankroll);
}

function today(){
  return new Date().toISOString().split("T")[0];
}

function profit(o,s,r){
  if(r==="win") return (o-1)*s;
  if(r==="loss") return -s;
  return 0;
}

function setTab(t){
  tab=t;
  render();
}

function adminLogin(){
  const pass = prompt("Enter admin password:");
  if(pass==="admin123"){
    tab="admin";
    render();
  }else{
    alert("Wrong password");
  }
}

function addBet(){
  bets.push({
    id:Date.now(),
    date:today(),
    match:"",
    market:"",
    odds:2,
    stake:100,
    result:"pending"
  });
  save();
  setTab("value");
}

function update(id, field, value){
  bets=bets.map(b=>b.id===id?{...b,[field]:value}:b);
  save();
  render();
}

function uploadCSV(e){
  const file=e.target.files[0];
  const reader=new FileReader();
  reader.onload=function(ev){
    ev.target.result.split("\n").forEach(line=>{
      const [match,market,odds,stake]=line.split(",");
      if(match){
        bets.push({
          id:Date.now()+Math.random(),
          date:today(),
          match:match.trim(),
          market:market.trim(),
          odds:parseFloat(odds)||0,
          stake:parseFloat(stake)||0,
          result:"pending"
        });
      }
    });
    save();
    setTab("value");
  };
  reader.readAsText(file);
}

function render(){

const content=document.getElementById("content");
content.innerHTML="";

if(tab==="value"){

  const table=document.createElement("table");
  table.innerHTML=`
  <tr>
    <th>Match</th>
    <th>Odds</th>
    <th>Stake</th>
    <th>Status</th>
  </tr>
  `;

  bets.filter(b=>b.date===today()).forEach(b=>{
    const row=document.createElement("tr");
    row.className = b.result==="win"?"win":b.result==="loss"?"loss":"";
    row.innerHTML=`
      <td><input value="${b.match}" onchange="update(${b.id},'match',this.value)"></td>
      <td><input type="number" value="${b.odds}" onchange="update(${b.id},'odds',parseFloat(this.value)||0)"></td>
      <td><input type="number" value="${b.stake}" onchange="update(${b.id},'stake',parseFloat(this.value)||0)"></td>
      <td>
        <select onchange="update(${b.id},'result',this.value)">
          <option value="pending">â³</option>
          <option value="win">âœ…</option>
          <option value="loss">âŒ</option>
        </select>
      </td>
    `;
    table.appendChild(row);
  });

  content.appendChild(table);
}

if(tab==="history"){
  const table=document.createElement("table");
  table.innerHTML=`
  <tr>
    <th>Match</th>
    <th>Result</th>
    <th>Profit</th>
  </tr>
  `;

  bets.filter(b=>b.result!=="pending").forEach(b=>{
    const p=profit(b.odds,b.stake,b.result);
    const row=document.createElement("tr");
    row.className=b.result;
    row.innerHTML=`
      <td>${b.match}</td>
      <td>${b.result==="win"?"âœ…":"âŒ"}</td>
      <td>Â£${p.toFixed(2)}</td>
    `;
    table.appendChild(row);
  });

  content.appendChild(table);
}

if(tab==="pl"){
  const stat=document.createElement("div");
  stat.className="stat-box";
  const totalProfit=bets.reduce((a,b)=>a+profit(b.odds,b.stake,b.result),0);
  stat.innerHTML=`
    Starting Bankroll (Â£):
    <input type="number" value="${startingBankroll}" onchange="startingBankroll=parseFloat(this.value)||0; save(); render();">
    <br><br>
    Current Bankroll: Â£${(startingBankroll+totalProfit).toFixed(2)}
  `;
  content.appendChild(stat);

  const canvas=document.createElement("canvas");
  content.appendChild(canvas);

  const ctx=canvas.getContext("2d");
  canvas.width=window.innerWidth-30;
  canvas.height=200;

  let history=bets.filter(b=>b.result!=="pending");
  let bankroll=startingBankroll;
  let points=[bankroll];

  history.forEach(b=>{
    bankroll+=profit(b.odds,b.stake,b.result);
    points.push(bankroll);
  });

  let max=Math.max(...points);
  let min=Math.min(...points);
  let range=max-min||1;

  ctx.strokeStyle="#10b981";
  ctx.beginPath();

  points.forEach((val,i)=>{
    const x=(canvas.width/(points.length-1))*i;
    const y=canvas.height-((val-min)/range)*canvas.height;
    if(i===0) ctx.moveTo(x,y);
    else ctx.lineTo(x,y);
  });

  ctx.stroke();
}

if(tab==="admin"){
  content.innerHTML=`
    <div class="stat-box">
      <button onclick="addBet()">â• Add Bet</button>
      <br><br>
      CSV Upload (Match,Market,Odds,Stake)
      <input type="file" accept=".csv" onchange="uploadCSV(event)">
    </div>
  `;
}

}

render();

</script>

</body>
</html>
